<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard de Damaris</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <style>
    :root {
      --menta: #a8edea;
      --lavanda: #fed6e3;
      --coral: #ff6f61;
      --aqua: #00c9a7;
      --nube: #f9f9fb;
      --texto: #2f2f3a;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--menta), var(--lavanda));
      min-height: 100vh;
      padding: 20px;
    }

    .dashboard {
      max-width: 1400px;
      margin: auto;
      background: var(--nube);
      border-radius: 24px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 3em;
      font-weight: 700;
      background: linear-gradient(90deg, var(--coral), var(--aqua));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.2em;
      color: var(--texto);
      opacity: 0.8;
    }

    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(520px, 1fr));
      gap: 30px;
    }

    .chart-container {
      background: white;
      border-radius: 20px;
      padding: 25px;
      border: 2px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s;
      min-height: 400px;
      display: flex;
      flex-direction: column;
    }

    .chart-container:hover {
      transform: translateY(-5px);
    }

    .chart-title {
      font-size: 1.5em;
      font-weight: 600;
      margin-bottom: 20px;
      text-align: center;
      color: var(--texto);
      flex-shrink: 0;
    }

    .chart-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    svg {
      border-radius: 12px;
      box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.04);
      border: 1px solid #e3e3e3;
      background: #ffffff;
    }

    .single-svg {
      width: 100%;
      height: 320px;
    }

    .dual-svg {
      display: flex;
      justify-content: space-between;
      gap: 15px;
      width: 100%;
      height: 320px;
    }

    .dual-svg svg {
      width: 48%;
      height: 100%;
    }

    .brush-container {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div class="dashboard">
    <div class="header">
      <h1>‚ú® Dashboard Visual Interactivo</h1>
      <p>por Damaris Yuselin Dzul Uc</p>
    </div>
    <div class="charts-grid">
      <div class="chart-container">
        <div class="chart-title">üéØ Drag & Drop</div>
        <div class="chart-content">
          <svg id="dragdrop" class="single-svg" viewBox="0 0 500 300"></svg>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">üåÄ Curva de Lissajous</div>
        <div class="chart-content">
          <svg id="lissajous" class="single-svg" viewBox="0 0 500 300"></svg>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">üìç Coordenadas del Mouse</div>
        <div class="chart-content">
          <svg id="coords" class="single-svg" viewBox="0 0 500 300" style="cursor:crosshair"></svg>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">üìä Barras Stagger</div>
        <div class="chart-content">
          <svg id="stagger" class="single-svg" viewBox="0 0 500 300"></svg>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">üîç Brush Scatter</div>
        <div class="chart-content brush-container">
          <div class="dual-svg">
            <svg id="brush1"></svg>
            <svg id="brush2"></svg>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
// Drag & Drop - Corregido con mejor espaciado
function makeDragDrop() {
  const svg = d3.select("#dragdrop");
  const colors = ["#00c9a7", "#ff6f61", "#8c9eff"];
  const positions = [125, 250, 375];

  positions.forEach((x, i) => {
    svg.append("circle")
      .attr("cx", x)
      .attr("cy", 150)
      .attr("r", 25)
      .attr("fill", colors[i])
      .attr("stroke", "#fff")
      .attr("stroke-width", 3)
      .style("cursor", "grab");
  });

  let widget, originalColor;

  const drag = d3.drag()
    .on("start", function () {
      originalColor = d3.select(this).attr("fill");
      widget = d3.select(this)
        .attr("fill", "#6c63ff")
        .style("cursor", "grabbing")
        .raise();
    })
    .on("drag", function (event) {
      const svgNode = svg.node();
      const pt = svgNode.createSVGPoint();
      pt.x = event.sourceEvent.clientX;
      pt.y = event.sourceEvent.clientY;
      const svgP = pt.matrixTransform(svgNode.getScreenCTM().inverse());

      const clampedX = Math.max(25, Math.min(475, svgP.x));
      const clampedY = Math.max(25, Math.min(275, svgP.y));

      widget.attr("cx", clampedX).attr("cy", clampedY);
    })
    .on("end", function () {
      widget
        .attr("fill", originalColor)
        .style("cursor", "grab");
      widget = undefined;
    });

  svg.selectAll("circle").call(drag);
}

// Lissajous - Ajustado para nuevo viewBox
function makeLissajous() {
  const svg = d3.select("#lissajous");
  let a = 1.9, b = 3.2;
  let phi, omega = 2 * Math.PI / 10000;
  let crrX = 250, crrY = 150, prvX = crrX, prvY = crrY; // Centrado en nuevo viewBox
  
  const timer = d3.timer(t => {
    phi = omega * t;
    crrX = 250 + 100 * Math.cos(a * phi); // Ajustado para 500px de ancho
    crrY = 150 + 100 * Math.sin(b * phi); // Ajustado para 300px de alto
    
    svg.selectAll("line")
      .each(function () { this.bogus_opacity *= .99 })
      .attr("stroke-opacity", function () { return this.bogus_opacity })
      .filter(function () { return this.bogus_opacity < 0.05 }).remove();
    
    svg.append("line")
      .each(function () { this.bogus_opacity = 1.0 })
      .attr("x1", prvX).attr("y1", prvY)
      .attr("x2", crrX).attr("y2", crrY)
      .attr("stroke", "#6c63ff")
      .attr("stroke-width", 2);
    
    prvX = crrX; 
    prvY = crrY;
    
    if (t > 120e3) timer.stop();
  });
}

// Coordenadas - Ajustado
function coordsPixels(selector) {
  const svg = d3.select(selector);
  const txt = svg.append("text")
    .attr("fill", "#333")
    .attr("font-size", "16px")
    .attr("font-weight", "600")
    .attr("font-family", "monospace");
  
  svg.on("mousemove", function (event) {
    const [x, y] = d3.pointer(event, svg.node());
    txt.attr("x", Math.min(x + 10, 420))
       .attr("y", Math.max(y - 10, 20))
       .text(`${Math.round(x)}, ${Math.round(y)}`);
  });
}

// Barras Stagger - Ajustado para nuevo viewBox
function makeStagger() {
  let ds1 = [2,1,3,5,7,8,9,9,9,8,7,5,3,1,2],
      ds2 = [8,9,8,7,5,3,2,1,2,3,5,7,8,9,8];
  
  const svg = d3.select("#stagger");
  const n = ds1.length, mx = d3.max(ds1.concat(ds2));
  const scX = d3.scaleLinear().domain([0, n]).range([40, 460]); // Ajustado
  const scY = d3.scaleLinear().domain([0, mx]).range([260, 40]); // Ajustado
  
  svg.selectAll("line").data(ds1).enter().append("line")
    .attr("stroke", "#ff6f61")
    .attr("stroke-width", 18)
    .attr("stroke-linecap", "round")
    .attr("x1", (d,i) => scX(i))
    .attr("y1", scY(0))
    .attr("x2", (d,i) => scX(i))
    .attr("y2", d => scY(d));
  
  svg.on("click", function() {
    [ds1, ds2] = [ds2, ds1];
    svg.selectAll("line").data(ds1)
      .transition()
      .duration(1000)
      .delay((d,i) => 200 * i)
      .attr("y2", d => scY(d));
  });
}

// Brush Scatter - Completamente redise√±ado
function makeBrushScatter() {
  const data = Array.from({ length: 150 }, () => ({
    A: Math.random() * 200 + 20, // Rango ajustado para el SVG
    B: Math.random() * 240 + 20
  }));

  const svg1 = d3.select("#brush1");
  const svg2 = d3.select("#brush2");
  
  // Obtener dimensiones reales de los SVGs
  const rect1 = svg1.node().getBoundingClientRect();
  const rect2 = svg2.node().getBoundingClientRect();
  
  svg1.attr("viewBox", `0 0 240 280`);
  svg2.attr("viewBox", `0 0 240 280`);

  const sc1 = d3.scaleLinear().domain([0, 40, 120]).range(["#00c9a7", "#f7b267", "#f25f5c"]);
  const sc2 = d3.scaleLinear().domain([0, 40, 120]).range(["#a0ced9", "#f7b267", "#6c63ff"]);

  const cs1 = drawScatter(svg1, data, sc1);
  const cs2 = drawScatter(svg2, data, sc2);

  svg1.style("cursor", "crosshair")
    .on("mousemove", function(event) {
      const [x, y] = d3.pointer(event, svg1.node());
      data.forEach((d) => {
        const dx = x - d.A;
        const dy = y - d.B;
        const r = Math.sqrt(dx * dx + dy * dy);
        d.r = r;
      });
      cs1.attr("fill", d => sc1(d.r));
      cs2.attr("fill", d => sc2(d.r));
    })
    .on("mouseleave", () => {
      data.forEach(d => d.r = Infinity);
      cs1.attr("fill", sc1(Infinity));
      cs2.attr("fill", sc2(Infinity));
    });

  function drawScatter(svg, data, scale) {
    return svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
      .attr("r", 4)
      .attr("cx", d => d.A)
      .attr("cy", d => d.B)
      .attr("fill", scale(Infinity))
      .attr("fill-opacity", 0.7)
      .attr("stroke", "#fff")
      .attr("stroke-width", 0.5);
  }
}

// Cargar funciones
document.addEventListener("DOMContentLoaded", function () {
  makeDragDrop();
  makeLissajous();
  coordsPixels("#coords");
  makeStagger();
  makeBrushScatter();
});
</script>
</body>
</html>