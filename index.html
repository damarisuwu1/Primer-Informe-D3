<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Damaris Yuselin Dzul UC</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<style>
    * {margin:0; padding:0; box-sizing:border-box}
    body {
        font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
        min-height:100vh;
        padding:20px;
    }
    .dashboard {
        max-width:1400px;
        margin:auto;
        background:#ffffff;
        border-radius:20px;
        padding:30px;
        box-shadow:0 20px 40px rgba(0,0,0,.1);
    }
    .header {
        text-align:center;
        margin-bottom:40px;
        color:#2c3e50;
    }
    .header h1 {
        font-size:2.5em;
        font-weight:300;
        margin-bottom:10px;
        background:linear-gradient(45deg,#667eea,#764ba2);
        -webkit-background-clip:text;
        -webkit-text-fill-color:transparent;
        background-clip:text;
    }
    .charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
        justify-content: center;
        gap: 30px;
        margin-bottom: 30px;
    }
    .chart-container {
        background:#f3f3f3;
        border-radius:15px;
        padding:25px;
        box-shadow:0 10px 25px rgba(0,0,0,.08);
        transition:.3s;
        width: 100%;
        max-width: 640px;
    }
    .chart-container:hover {transform:translateY(-2px);}
    .chart-title {
        font-size:1.3em;
        font-weight:600;
        color:#2c3e50;
        margin-bottom:20px;
        text-align:center;
    }
    svg {
        display: block;
        margin: auto;
        background: #dcdcdc;
        border-radius: 8px;
        width: 100%;
        height: auto;
        max-height: 320px;
    }
    .dual-svg {
        display:flex;
        justify-content:center;
        gap:20px;
        flex-wrap:wrap;
    }
</style>
</head>
<body>
<div class="dashboard">
    <div class="header">
        <h1>üìä Damaris Yuselin Dzul UC</h1>
        <p>Visualizaci√≥n de datos con D3.js</p>
    </div>
    <div class="charts-grid">
        <div class="chart-container">
            <div class="chart-title">üéØ Drag & Drop</div>
            <svg id="dragdrop" viewBox="0 0 600 250"></svg>
        </div>
        <div class="chart-container">
            <div class="chart-title">üåÄ Curva de Lissajous</div>
            <svg id="lissajous" viewBox="0 0 600 300"></svg>
        </div>
        <div class="chart-container">
            <div class="chart-title">üìç Coordenadas del Mouse</div>
            <svg id="coords" viewBox="0 0 600 300" style="cursor:crosshair"></svg>
        </div>
        <div class="chart-container">
            <div class="chart-title">üìä Barras Stagger</div>
            <svg id="stagger" viewBox="0 0 600 300"></svg>
        </div>
        <div class="chart-container">
            <div class="chart-title">üîç Brush Scatter</div>
            <div class="dual-svg">
                <svg id="brush1" width="300" height="300"></svg>
                <svg id="brush2" width="300" height="300"></svg>
            </div>
        </div>
    </div>
</div>

<script>
// === Drag & Drop ===
function makeDragDrop() {
  const svg = d3.select("#dragdrop");
  svg.append("circle").attr("cx",150).attr("cy",125).attr("r",20).attr("fill","red");
  svg.append("circle").attr("cx",300).attr("cy",125).attr("r",20).attr("fill","green");
  svg.append("circle").attr("cx",450).attr("cy",125).attr("r",20).attr("fill","blue");
  let widget, color;
  const drag = d3.drag()
    .on("start", function() {
      color = d3.select(this).attr("fill");
      widget = d3.select(this).attr("fill", "lime");
    })
    .on("drag", function(event) {
      const [x, y] = d3.pointer(event, svg.node());
      widget.attr("cx", x).attr("cy", y);
    })
    .on("end", function() {
      widget.attr("fill", color);
      widget = undefined;
    });
  drag(svg.selectAll("circle"));
}

// === Lissajous Curve ===
function makeLissajous() {
  const svg = d3.select("#lissajous");
  let a = 1.9, b = 3.2;
  let phi, omega = 2*Math.PI/10000;
  let crrX = 300, crrY = 150;
  let prvX = crrX, prvY = crrY;
  const timer = d3.timer(t => {
    phi = omega * t;
    crrX = 300 + 100 * Math.cos(a * phi);
    crrY = 150 + 100 * Math.sin(b * phi);
    svg.selectAll("line")
      .each(function() { this.bogus_opacity *= .99 })
      .attr("stroke-opacity", function() { return this.bogus_opacity })
      .filter(function() { return this.bogus_opacity < 0.05 }).remove();
    svg.append("line")
      .each(function() { this.bogus_opacity = 1.0 })
      .attr("x1", prvX).attr("y1", prvY)
      .attr("x2", crrX).attr("y2", crrY)
      .attr("stroke", "green").attr("stroke-width", 2);
    prvX = crrX; prvY = crrY;
    if(t > 120e3) timer.stop();
  });
}

// === Coordenadas del Mouse ===
function coordsPixels(selector) {
  const svg = d3.select(selector);
  const txt = svg.append("text").attr("fill", "black").attr("font-size", "14px");
  svg.on("mousemove", function(event) {
    const [x, y] = d3.pointer(event, svg.node());
    txt.attr("x", x + 18).attr("y", y + 6).text(`${Math.round(x)}, ${Math.round(y)}`);
  });
}

// === Stagger Chart ===
function makeStagger() {
  let ds1 = [2,1,3,5,7,8,9,9,9,8,7,5,3,1,2],
      ds2 = [8,9,8,7,5,3,2,1,2,3,5,7,8,9,8];
  const n = ds1.length, mx = d3.max(ds1.concat(ds2));
  const svg = d3.select("#stagger");
  const scX = d3.scaleLinear().domain([0, n]).range([50, 540]);
  const scY = d3.scaleLinear().domain([0, mx]).range([250, 50]);
  svg.selectAll("line").data(ds1).enter().append("line")
    .attr("stroke", "red").attr("stroke-width", 20)
    .attr("x1", (d,i) => scX(i)).attr("y1", scY(0))
    .attr("x2", (d,i) => scX(i)).attr("y2", d => scY(d));
  svg.on("click", function() {
    [ds1, ds2] = [ds2, ds1];
    svg.selectAll("line").data(ds1)
      .transition().duration(1000).delay((d,i) => 200 * i)
      .attr("y2", d => scY(d));
  });
}

// === Brush Scatter ===
function makeBrushScatter() {
  d3.csv("data/dense.csv").then(data => {
    data.forEach(d => { d.A = +d.A; d.B = +d.B; });

    const svg1 = d3.select("#brush1"),
          svg2 = d3.select("#brush2");

    const sc1 = d3.scaleLinear().domain([0, 10, 50]).range(["lime", "yellow", "red"]);
    const sc2 = d3.scaleLinear().domain([0, 10, 50]).range(["lime", "yellow", "blue"]);

    const cs1 = drawCircles(svg1, data, d => d.A, d => d.B, sc1);
    const cs2 = drawCircles(svg2, data, d => d.A, d => d.B, sc2);

    installHandlers(svg1, data, cs1, cs2, sc1, sc2);
  });

  function drawCircles(svg, data, accX, accY, sc) {
    const color = sc(Infinity);
    return svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
      .attr("r", 5)
      .attr("cx", accX)
      .attr("cy", accY)
      .attr("fill", color)
      .attr("fill-opacity", 0.4);
  }

  function installHandlers(svg, data, cs1, cs2, sc1, sc2) {
    svg.attr("cursor", "crosshair")
      .on("mousemove", function () {
        const pt = d3.mouse(this);
        cs1.attr("fill", function (d, i) {
          const dx = pt[0] - +d3.select(this).attr("cx");
          const dy = pt[1] - +d3.select(this).attr("cy");
          const r = Math.hypot(dx, dy);
          data[i].r = r;
          return sc1(r);
        });
        cs2.attr("fill", (d, i) => sc2(data[i].r));
      })
      .on("mouseleave", function () {
        cs1.attr("fill", sc1(Infinity));
        cs2.attr("fill", sc2(Infinity));
      });
  }
}

// === Lanzar funciones al cargar ===
document.addEventListener("DOMContentLoaded", function() {
  makeDragDrop();
  makeLissajous();
  coordsPixels("#coords");
  makeStagger();
  makeBrushScatter();
});
</script>
</body>
</html>
